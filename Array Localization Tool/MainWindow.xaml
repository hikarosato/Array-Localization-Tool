<Window x:Class="Array_Translate_Tool.MainWindow" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Title="Array Localization Tool 3.0" Height="600" Width="950"
        MinHeight="600" MinWidth="950" WindowStartupLocation="CenterScreen" Closing="Window_Closing" KeyDown="Window_KeyDown"
        Background="{DynamicResource WindowBackgroundBrush}">
    <DockPanel>
        <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Height="27" Margin="0,5,0,0">
            <Menu HorizontalAlignment="Center" Background="{DynamicResource MenuBackgroundBrush}" 
                  Foreground="{DynamicResource MenuForegroundBrush}">
                <MenuItem Header="Файл" Height="27">
                    <MenuItem x:Name="BtnOpen" Header="Відкрити" Click="BtnOpen_Click" InputGestureText="Ctrl+O"/>
                    <MenuItem x:Name="BtnSave" Header="Зберегти як..." Click="BtnSave_Click" InputGestureText="Ctrl+S"/>
                </MenuItem>
                <MenuItem Header="Редагувати">
                    <MenuItem x:Name="BtnLoadTranslation" Header="Імпорт з JSON" Click="BtnLoadTranslation_Click"/>
                    <Separator />
                    <MenuItem x:Name="BtnExportCsv" Header="Експорт у CSV" Click="BtnExportCsv_Click"/>
                    <MenuItem x:Name="BtnImportCsv" Header="Імпорт з CSV" Click="BtnImportCsv_Click"/>
                    <Separator />
                    <MenuItem x:Name="BtnRestoreAll" Header="Повернути оригінал в усі рядки" Click="BtnRestoreAll_Click"/>
                </MenuItem>
                <MenuItem Header="?">
                    <MenuItem x:Name="BtnTheme" Header="Темна тема" Click="BtnTheme_Click"/>
                    <Separator />
                    <MenuItem Header="Про програму" Click="BtnAbout_Click"/>
                </MenuItem>
            </Menu>
            <Border Width="1" Background="#abadb3" Margin="3,0"/>
            <ToggleButton x:Name="TglSearchByID" Content="Текст" Margin="3" Width="40" VerticalAlignment="Center"
                          Checked="TglSearchByID_Checked" Unchecked="TglSearchByID_Unchecked" IsEnabled="False"/>
            <TextBox x:Name="TxtSearch" Width="300" Margin="3,0,3,0" KeyDown="TxtSearch_KeyDown" 
                     VerticalContentAlignment="Center" FontSize="14"
                     Background="{DynamicResource TextBoxBackgroundBrush}"
                     Foreground="{DynamicResource TextBoxForegroundBrush}"/>
            <Button x:Name="BtnSearch" Content="🔍" Width="21" Margin="3" Click="BtnSearch_Click" IsEnabled="False"/>
            <CheckBox x:Name="ChkCase" Content="З урах. регістру" Margin="6" 
                      Foreground="{DynamicResource TextForegroundBrush}"/>
            <CheckBox x:Name="ChkExact" Content="Точний збіг рядка" Margin="6"
                      Foreground="{DynamicResource TextForegroundBrush}"/>
            <Button x:Name="BtnPrev" Content="⯇" Width="21" Margin="3" Click="BtnPrev_Click" IsEnabled="False"/>
            <Button x:Name="BtnNext" Content="⯈" Width="21" Margin="3" Click="BtnNext_Click" IsEnabled="False"/>
            <Label x:Name="LblSearchStatus" Margin="5,0,0,0" 
                   Foreground="{DynamicResource TextForegroundBrush}"/>
        </StackPanel>
        <Grid Margin="5">
            <Grid.RowDefinitions>
                <RowDefinition Height="4*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="2*"/>
            </Grid.RowDefinitions>
            <DataGrid x:Name="DataGridTerms" AutoGenerateColumns="False" Grid.Row="0" SelectionMode="Single" SelectionUnit="FullRow"
                      IsReadOnly="False" SelectionChanged="DataGridTerms_SelectionChanged" CellEditEnding="DataGridTerms_CellEditEnding"
                      CanUserAddRows="False" Visibility="Collapsed" HorizontalScrollBarVisibility="Disabled" GridLinesVisibility="None"
                      CanUserResizeRows="False"
                      Background="{DynamicResource DataGridBackgroundBrush}"
                      Foreground="{DynamicResource TextForegroundBrush}"
                      RowHeaderWidth="0">
                <DataGrid.Resources>
                    <Style TargetType="DataGridCell">
                        <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
                        <Setter Property="BorderThickness" Value="0.5"/>
                        <Setter Property="Foreground" Value="{DynamicResource TextForegroundBrush}"/>
                        <Style.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="{DynamicResource DataGridSelectionBrush}"/>
                                <Setter Property="Foreground" Value="{DynamicResource DataGridSelectionForegroundBrush}"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="{DynamicResource MenuBackgroundBrush}"/>
                        <Setter Property="Foreground" Value="{DynamicResource MenuForegroundBrush}"/>
                        <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
                        <Setter Property="BorderThickness" Value="0,0,1,1"/>
                        <Setter Property="Padding" Value="5,3"/>
                    </Style>
                    <Style TargetType="DataGridRowHeader">
                        <Setter Property="Background" Value="{DynamicResource MenuBackgroundBrush}"/>
                        <Setter Property="Foreground" Value="{DynamicResource MenuForegroundBrush}"/>
                        <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
                    </Style>
                </DataGrid.Resources>
                <DataGrid.RowStyle>
                    <Style TargetType="DataGridRow">
                        <Setter Property="Background" Value="{DynamicResource DataGridBackgroundBrush}"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsModified}" Value="True">
                                <Setter Property="Background" Value="{DynamicResource ModifiedRowBrush}"/>
                            </DataTrigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="{DynamicResource DataGridSelectionBrush}"/>
                                <Setter Property="Foreground" Value="{DynamicResource DataGridSelectionForegroundBrush}"/>
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsSelected" Value="True"/>
                                    <Condition Property="IsFocused" Value="False"/>
                                </MultiTrigger.Conditions>
                                <Setter Property="Background" Value="{DynamicResource DataGridSelectionBrush}"/>
                                <Setter Property="Foreground" Value="{DynamicResource DataGridSelectionForegroundBrush}"/>
                            </MultiTrigger>
                        </Style.Triggers>
                    </Style>
                </DataGrid.RowStyle>
                <DataGrid.Columns>
                    <DataGridTextColumn Header="№" Width="auto" IsReadOnly="True" Binding="{Binding Number}" CanUserSort="False"/>
                    <DataGridTextColumn Header="ID" Width="200" IsReadOnly="True" Binding="{Binding Term}" CanUserSort="False"/>
                    <DataGridTextColumn Header="Оригінал" Width="250" IsReadOnly="True" Binding="{Binding Original}" CanUserSort="False"/>
                    <DataGridTextColumn Header="Переклад" Width="*" IsReadOnly="True" Binding="{Binding Translation, UpdateSourceTrigger=PropertyChanged}" CanUserSort="False"/>
                </DataGrid.Columns>
            </DataGrid>
            <DockPanel Grid.Row="1" Margin="0,5,0,5" Height="23" LastChildFill="False">
                <StackPanel Orientation="Horizontal" x:Name="StatsPanel" DockPanel.Dock="Left" VerticalAlignment="Center" Visibility="Collapsed">
                    <TextBlock Text="К-сть рядків: " Foreground="{DynamicResource TextForegroundBrush}"/>
                    <TextBlock x:Name="LblTotalRows" FontWeight="Bold" Margin="0,0,20,0" Foreground="{DynamicResource TextForegroundBrush}"/>
                    <TextBlock Text="К-сть слів: " Foreground="{DynamicResource TextForegroundBrush}"/>
                    <TextBlock x:Name="LblTotalWords" FontWeight="Bold" Margin="0,0,20,0" Foreground="{DynamicResource TextForegroundBrush}"/>
                    <TextBlock Text="Перекладено рядків: " Foreground="{DynamicResource TextForegroundBrush}"/>
                    <TextBlock x:Name="LblTranslatedRows" FontWeight="Bold" Margin="0,0,20,0" Foreground="{DynamicResource TextForegroundBrush}"/>
                    <TextBlock Text="У відсотках: " Foreground="{DynamicResource TextForegroundBrush}"/>
                    <TextBlock x:Name="LblTranslatedPercent" FontWeight="Bold" Margin="0,0,20,0" Foreground="{DynamicResource TextForegroundBrush}"/>
                </StackPanel>
                <Button x:Name="BtnRestoreOriginal" Content="Повернути оригінал" Click="BtnRestoreOriginal_Click" Width="130"
                        VerticalAlignment="Center" DockPanel.Dock="Right"/>
            </DockPanel>
            <TextBox x:Name="TxtTranslation" Grid.Row="2" AcceptsReturn="False" FontSize="14" VerticalScrollBarVisibility="Auto" TextWrapping="Wrap"
                     BorderThickness="2" FontWeight="Bold" TextChanged="TxtTranslation_TextChanged" Background="{DynamicResource TextBoxBackgroundBrush}"
                     Foreground="{DynamicResource TextBoxForegroundBrush}"/>
        </Grid>
    </DockPanel>
</Window>